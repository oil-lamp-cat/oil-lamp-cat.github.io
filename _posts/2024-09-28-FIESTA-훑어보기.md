---
title: "[FIESTA 2024] 금융보안 위협분석 대회 PlayZone문제"
date: 2024-09-28 16:19:15 +09:00
categories: [Linux, 보안, 해킹, CTF]
tags: [FIESTA 2024, playzone]
pin: true
---

# FIESTA 2024 금융보안 위협분석 대회

 나는 아직 정식으로 보안에 관해 배운적이 없는 **스크립트 키디(script kiddie)**로 보안이나 바이러스, 악성코드 분석 등에 관한 내용은 거의 알지 못한다.

 하지만 이번 대회는 대학생 혹은 기업 신분인 사람들 누구나 참가비 없이 참여할 수 있기에 한번 참여를 해보았다.

 대회에서 몇등을 하겠다라는 목표는 없지만 한 문제라도 한번 도전해보고 싶다.

 일정은 다음과 같다.

 ```
    플레이존 : 09.23. (월) 09:00 ~ 10.02 (수) 18:00
    대회 : 10.04. (금) 18:00 ~ 10.06. (일) 24:00 (2박 3일) 
 ```

 이번 대회는 CTF(Capture The Flags)대회라고 한다.

 내가 해본 다른 워게임과의 차이점이라면 서버가 아니라는점? 자세한건 직접 문제를 풀어보면서 기록해보자.

 ## PLAYZONE

 > 이곳에서는 여러 테스트 문제들을 풀어볼 수 있다.

 일단 모든 문제를 찍먹해보고 풀 수 있는 것들은 풀 것이다

 ![image](https://github.com/user-attachments/assets/367e959f-76a3-461b-bc23-12ed195c76e3)

 ### TEST
 ![image](https://github.com/user-attachments/assets/0e478b8a-16b3-4360-927b-2ef65495d9f1)

 FLAG가 잘 작동되는지 테스트하는 문제이다.

 `Input Flag`에 `fiesta{MIC_TEST}`을 입력하고 `Submit Flag`를 누르면 끝.

 문제 푸는데 성공했다면 `Correct!` 라고 뜰 것이다.

 ### 시나리오

 #### APT(Advanced Persistent Threat) 1
 
 ![image](https://github.com/user-attachments/assets/8d5c5aa2-ae68-4314-b2fa-dceed06962c0)

 공격자가 피해자에게 악성코드를 메일로 보냈고 그 파일에서 악성코드를 찾아서 sha256값을 이용하라고 한다.

 일단 먼저 파일을 받아보자.

 ![image](https://github.com/user-attachments/assets/6a04b8dd-3f8e-4da1-9968-ede9b1759c2e)

 이 파일안에는 `.eml`파일이 있을 것이다. 그리고 이 확장자는 당연하게도 이메일 확장자이다.

 ![image](https://github.com/user-attachments/assets/e456a7e2-f12d-43a8-b4f2-02c7536b3596)

 총 `email0000.eml`-`email0099.eml`까지 100개의 이메일이 존재한다.

 여기서 바이러스가 있는 파일을 찾으려면 어떻게 해야할까?

 나는 그냥 [VIRUSTOTAL](https://www.virustotal.com/gui/home/upload)에 하나하나 넣어보기로 했다.

 분명 `virustotal api`를 받아서 하거나 한번에 모든 파일을 검사할 수 있는 방법도 있겠지만 나는 모르기에 하나하나 직접 넣었다.

 일단 내용이 무엇일지 궁금하니 돌려봤을 때 문제가 없었던 `email0000.eml`을 한번 열어보자.

 ![image](https://github.com/user-attachments/assets/9f4bcd58-a290-40ab-aab9-f5f6548b134f)

 어...

 ```
 미스터 옵션 웃음 목록을 포함한 이유일 수 있습니다. 학생들이 재정적 진실을 지지합니다. 진짜 5는 없습니다.
 훌륭한 작가가 앞서 선물했습니다. 가을 아들은 평화의 고객을 의미합니다.
 [중략]
 ```

 이라는데 그냥 아무말이나 쓴 듯 하다.

 ![image](https://github.com/user-attachments/assets/f5b58dca-0390-4fdd-a1dd-0b3598a4614e)

 일단 `email0007.eml`을 찾아냈다.

 음... 하나하나 하기에는 너무 많아서 그냥 `output.zip`파일을 돌려보았다.

 ![image](https://github.com/user-attachments/assets/36fd1091-405e-438f-9f1e-a14fb5c5101f)

 오호 이렇게 한번에 내부 파일을 읽어서 알려줄 거라고는 생각을 못했다.

 찾은 결과는 `email0007.eml`, `email0027.eml`, `email0028.eml`, `email0047.eml`, `email0071.eml`, `email0073.emal`로 총 6개이다.

 ![image](https://github.com/user-attachments/assets/148fe861-09cd-42e7-8b1c-e8dc46b7a301)

 일단 이 친구들을 하나의 폴더에 모았다.

 그 후에 `munpack`을 이용해서 첨부 파일들을 추출해보자.

 ![image](https://github.com/user-attachments/assets/26e562c0-15da-4a97-9f55-7e6c5108c445)
 
 ```bash
 for file in *.eml; do munpack "$file"; done
 ```

 를 이용해서 `.eml`파일 전부를 한번에 추출할 수 있다.

 ![image](https://github.com/user-attachments/assets/7f1787d1-89bd-49f9-a8f3-43a552644be6)

 이 파일들 중 우리는 `.*zip`파일에 문제아가 있다는 것을 다시한번 `VIRUSTOTAL`의 힘을 빌려 알아낼 수 있다.

 ![image](https://github.com/user-attachments/assets/945e3240-22ca-480f-a201-c02697ecc329)

 게다가 각 `zip`파일마다 `.exe`확장파일이 존재함을 알 수 있다.

 ![image](https://github.com/user-attachments/assets/f388404d-6e87-4b00-a22b-f09651699d4f)

 전부 `zip`파일을을 풀어보니 확실히 `.exe`파일이 많다. 
 
 ![image](https://github.com/user-attachments/assets/138df50c-54f5-4f76-9dca-e684c4a955e1)

 그리고 또한 `.docx`파일이 많은데 `VIRUSTOTAL`에서 문제가 없다고 하니 열어보면 역시 딱히 의미없는 글이다.

 ![image](https://github.com/user-attachments/assets/696d6b9a-7662-4567-b6b3-be7a50a86c80)

 그렇다면 진짜로 이중에 범인이 있다는 의미인데...

 > animalxawa4bw0.exe

 ![image](https://github.com/user-attachments/assets/0245dea9-c839-452a-b208-8adb9f22719a)

 이 친구는 `악성 소프트웨어(멀웨어)`, `트로이의 목마`라고 나온다.

 > becauseq1af2332.exe

 ![image](https://github.com/user-attachments/assets/d0a21878-7a2c-4aee-a9ce-b5155622d155)

 이번에는 위 결과에 추가적으로 `백도어`라고 한다.

 > glasszyamgvv7.exe

 ![image](https://github.com/user-attachments/assets/49d90dbf-62b8-49fe-8268-5ee94e755833)

 와 이번에는 구글에서도 감지되었다고 뜨고 뭔가 훨씬 많은 것들이 추가되었다. 이건가?

 > until1818qf2.exe

 ![image](https://github.com/user-attachments/assets/36492110-8234-46ac-bfa3-5a61d59ef717)

 이번에도 4가지 정도 나온다.

 > word5f1ew949.exe

 ![image](https://github.com/user-attachments/assets/912c6e01-f923-4944-b054-428c8e7d70b4)

 너도?

 마지막으로 내가 까먹고 압축해제를 하지 않은 `28`번도 있다. 여기서는 `poo`라는 파일이 나온다. 그리고 그 안에는 `somebodyrce_fx8b.exe`도 있다.

 > somebodyrce_fx8b.exe

 ![image](https://github.com/user-attachments/assets/bc73087f-c194-4e5f-aaa8-27dedac0b9e9)

 이야 도대체 누가 범인인걸까?

 일단 문제에서는 악성코드의 `sha256` 해쉬값을 얻어내라고 했었다.

 일단 한번 전부 다 넣어볼까? (BruteForce)

 ![image](https://github.com/user-attachments/assets/35104a4e-5a6f-4a93-8017-aa6aa1883913)

 하나하나 넣어보니 `bcb10a8e6250ecb142932ba59cbe94e47f2e143564df1886a5838317bc275b40  becauseq1af2332.exe` 이녀석이 범인이였다.

 혹시 내가 뭔지 알 수 있을까 해서 뜯어봤는데

 ![image](https://github.com/user-attachments/assets/f6cac5f8-7c91-41d3-aa05-e542448f2c99)

 음... 역시나 어느정도만 이해가 되고 뭐하는 작업인지 모르겠다.

 > FLAG : `fiesta{bcb10a8e6250ecb142932ba59cbe94e47f2e143564df1886a5838317bc275b40}`

 #### APT(Advanced Persistent Threat) 2

 ![image](https://github.com/user-attachments/assets/f5db9566-da27-4579-b656-8ab981e3f73e)

 이번에는 패킷 로그가 있고 까지 이해했다. 이걸로 악성코드를 분석할 수 있는건가?

 일단 한번 파일을 받아보자

 ![image](https://github.com/user-attachments/assets/2208c834-048c-4211-a20d-fcd4235390d5)

 오케이 패킷 로그파일만 있는 것을 확인했다. 일단 한번 `Wireshark`로 열어보자.

 ![image](https://github.com/user-attachments/assets/4c1c5c07-ed9b-49c6-b714-4fd8d8572d29)

 오... 케이...

 [Command & Control 서버를 이용하는 악성행위 분석](https://www.igloo.co.kr/security-information/command-control-%EC%84%9C%EB%B2%84%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%98%EB%8A%94-%EC%95%85%EC%84%B1%ED%96%89%EC%9C%84-%EB%B6%84%EC%84%9D/)

 일단 아는 것이 없으니 [wireshark 패킷 분석 / 악성코드 추출 / 네트워크 포렌식](https://wisetrue.tistory.com/217)을 따라가 보자. 모든 시작은 모방인 것이여

 그 전에 저녁먹고 다시 시작

 ### 침해대응

 ### 특별문제