---
title: "[udemy] 화이트 해킹 101: 윤리적 해킹 기초부터 배우기!"
date: 2024-08-21 14:36:15 +09:00
categories: [udemy]
tags: [linux, hacking]
pin: true
---

# 신청한 udemy 강의 목록

- \[한글자막] 화이트 해킹 101: 윤리적 해킹 기초부터 배우기!
- The RedTeam Blueprint - A Unique Guide To Ethical Hacking
- Learn Python & Ethical Hacking From Scratch
- Web Security & Bug Bounty: Learn Penetration Testing

아니 원래 가격이 총 다 합해서 330,000원인데 이번에 할인(사실 이게 원가)를 하면서 50,000원이 되었다

세상에 이걸 어떻게 참아

아무래도 관심이 있었던 분야이기에 한번 공부하며 정리해 보기로 했다

# \[한글자막] 화이트 해킹 101: 윤리적 해킹 기초부터 배우기!

내가 선택한 강의 중에 유일하게 한글자막이 있고 꽤나 느리게 말하기에 편하게 보기 좋을것 같아 처음으로 선택했다

## 1. 강의 개요
### 1-1. 맛보기 - 윈도우 11 컴퓨터를 해킹하고 웹캠 액세스하기

말 그대로 강의가 끝나면 어떤 작업들을 할 수 있을지에 관해 미리 보여주는 강의다

`wargame`을 두루 해봤다면 꽤 익숙한 kali를 이용하는 모습을 볼 수 있다

### 1-2. 강의 소개 및 개요

강의는 아래와 같이 이루어진다

1. Network Hacking

네트워크 통신간의 데이터를 가로체거나 변경 등 네트워크에 대해

2. Gaining Access

서버와 개인 컴퓨터에 액세스 하는 방법 공부

타겟에  대한 정보 확보, 취약점 파악, 공격 및 제어

3. Post Exploitation

접근에 성공한 후 무엇을 할 수 있는지에 관해

4. Website Hacking

웹사이트의 동작 방식, 타겟에 대한 정보 취득, 제어

### 1-3. 해킹은 무엇이며 왜 학습해야 하는가

> 해킹은 무엇인가?

액세스 할 수 없어야 하는 시스템에 대한 액세스 권한을 획득하는 것

혹은 일반적으로 수행할 수 없는 작업을 수행하는 것

`create-react-app`을 실행하면 `'happy hacking!'`이라는 문구가 뜨는데 이건 그냥  `'즐겁고 멋지게 문제를 해결하세요!'`라는 뜻이라카더라

> 해커의 3가지 유형

- Black-hat hacker (불법)

불법적인 목적을 위해 시스템을 해킹

- White-hat hacker (합법)

블랙햇과 동일하지만 해킹할 권한이 주어진 시스템만 해킹

- Grey-hat hacker (불법)

권한이 없더라도 시스템을 해킹하지만 돈을 훔치거나 시스템에 피해를 주지는 않는 사람

> 왜 해킹을 배우는가?

- 해킹은 이미 구축된 산업이다, 즉 이미 상업적으로 활성화된 직업이 되었다
- 윤리적 해커를 위한 취직길이 있다 (한국에도 있는지는 의문)
- 블랙햇 해커로부터 시스템의 보안 안전을 테스트 할 수 있다
- 실제로 요즘 해킹 공격 횟수가 늘고 있다

## 2. 해킹 랩(Lab) 설정

나는 평소에 VBox(Virtual Box)를 쓰곤 했는데 이 강의에서는 VMWare를 쓰는 문제가..

하지만 일단 따라가 봅시다

### 2-1. 업데이트 공지

시간이 지나도 그에 맞게 강의가 업데이트 된다고 한다

아주 좋아요

### 2-2. 랩(Lab) 개요

> 랩(Lab)

새로운 것을 발견했거나 테스트 해보고 싶을 때 나만의 테스트 장소인 랩(Lab)

하지만 만약 네트워크 관련 작업을 하거나 웹 서버 공격 테스트를 하게 된다면 그에 맞춘 컴퓨터 혹은 네트워크 시스템을 구축해야 한다

그것을 쉽게 해주는 것이 바로 가상머신(VM)이다

Host Machine에서 내가 하던대로 컴퓨터를 쓰고 그 안에 가상의 컴퓨터들을 만들어 랩을 만들 수 있다

호스트 컴퓨터에는 전혀 영양을 주지 않기에 가상머신이 고장나더라도 `snapshot`을 이용해 고장나기 전으로 되돌아 갈 수 있다

이번에 우리는 

- Debian
- Metasploitable
- Windows10
- Kali Linux
- Ubuntu

를 쓴다고 한다

내 노트북에는 이미 Ubuntu와 Kali가 설치되어있지만 네트워크 상에서 해킹하고 외부에 취약한 부분이 드러나지 않으려면 보안적으로도 VM을 사용하는 것이 좋다

### 2-3. 기초 준비작업

#### Kali Linux

Debian 기반의 리눅스 배포판으로 여러 해킹 및 침투 테스트를 위한 툴이 미리 설치에어있다

요즘에는 offensive 칼리를 `Kali Linux Blue`, defensive 칼리를 `Kali Linux Purple`로 나눠놓았다

여기서는 Blue 버전(강의에서 제공된 버전)을 사용한다

설치를 위해 `Virtualization`을 사용함으로 설정하라고 하는데 나는 이미 VMBOX 덕분에 활성화 되어있다

### 2-4. 윈도우에 칼리 리눅스를 가상 머신으로 설치하기

어... 근데 이거 pro 버전인데 설치 해도 되는거 맞나?

아니 뭐야 찾아보니까 `Workstation Player`가 단종되면서 `Pro`버전이 개인 무료 사용으로 라이센스가 변경되었다네??

일단 설치는 매우 간단하다 영상 따라 링크 들어가서 VMware 설치하면 된다

그 후에 클릭 엔 드래그 해서 설치하면 끝

중간에 7-zip깔라고 하는데 나는 그냥 `bandizip`을 사용했다

![image](https://github.com/user-attachments/assets/f5d53f65-0f2d-4856-860e-092f094041e2)

다 좋은데 너무 느리다 2GB메모리는 좀 너무 적었을 지도

음.. 그게 문제가 아닌거 같은데..? 로그인은 되는데 그 이후에 검은 화면만 뜬다

![image](https://github.com/user-attachments/assets/49cb68c6-ede9-4bac-bd18-80489a009df7)

역시 GPU가속을 끄니 잘 나온다.. 허.. 혹시했는데 역시네

하도 내가   `Kali usb Portable`버전만 써서 그런지 되게 이쁘다.. 우분투 삭제하고 갈아탈까 생각이 들 정도

[checksum](https://oil-lamp-cat.github.io/posts/window-checksum/) 체크섬 하는법

### 2-5. mac에 칼리 리눅스 가상머신으로 설치하기

이 부분은 내가 Linux랑 Window만 쓰기에 넘어갔다

### 2-6. 리눅스에 칼리 리눅스를 가상 머신으로 설치하기

우분투는 노트북에 깔려 있기에 굳이 본 컴퓨터가 아닌 곳에 vm을 깔지는 않을 것이다

## 3. 리눅스 기초

말 그대로 리눅스 기초에 관한 내용이다

평소에 다른 os를 써본 사람이라면 넘겨도 될 부분이다

### 3-1. Kali 기초

평생 윈도우만 써와서 리눅스 gui(gnome)에 관해 모르는 사람을 위한 기초적인 강의

### 3-2. 단말(terminal)과 리눅스 명령어

> bash 스크립트를 짜봤다면 패스

`pwd` :  print working directory, 현재 디렉토리 출력

`ls` : list, 디렉토리 내용 출력

`cd` : 디렉토리 이동, `cd ..`으로 루트 폴더로 이동

`man` : 명령어에 대한 메뉴얼 표시


`clear` : 터미널 청소

업데이트 ->
```
root일 경우
apt-get update
apt-get upgrade

일반
sudo apt-get update
sudo apt-get upgrade
```

프로그램 설치 ->
```
apt-get install [프로그램 이름]
```

[리눅스 명령어 모음](https://namu.wiki/w/Linux/%EB%AA%85%EB%A0%B9%EC%96%B4#s-2.3)

나는 `tmux`를 자주 쓰곤 했는데 이 강의에서는 `terminator`를 사용한다

```
sudo apt-get install terminator
```

## 4. 네트워크 해킹

### 4-1. 네트워크 침투 테스트 및 해킹 개요

개인 컴퓨터, 기업 서버, 웹사이트 모두 결국에는 네트워크에 연결되기에 네트워크의 작동 방식에 대한 강의로 시작된다

1. 네트워크에 연결하기 전에 할 수 있는 공격
2. 네트워크에 액세스
3. 액세스 후에 할 수 있는 공격

네트워크를 중간에 가로채거나 그 안에서 전송되는 데이터들을 캡쳐, 변형하여 요청을 제어하거나 악성코드를 삽입하는 등의 작업이 가능해진다

### 4-2. 네트워크 기초

클라이언트는 `엑세스 포인트(AP)`(서버혹은 라우터)를 통해서만 네트워크에 접속해서 리소스(데이터)를 가져올 수 있다

```
client1---|
          |
client2---|-- Access Point -- Resources
          |
client3---|
```

연결된 모든 클라이언트가 리소스에 액세스 하려면 라우터를 거치게 되고 데이터(Resources)는 패킷의 형태로 전송된다

> 스니핑

만약 유선이 아닌 와이파이를 사용하게 된다면 내가 `무선 네트워크 카드`가 있듯 다른 누구든 `무선 네트워크 카드`가 있을 것이니 같은 공간 범위 내에만 있다면 모든 요청과 응답을 캡쳐해서 볼 수 있다

아무래도 역시 해킹의 시작은 관심인지라 가장 간단하면서도 확실한 와이파이 해킹을 먼저 시작하게 되는 것 같다

연례행사

### 4-3. 칼리에 무선 어댑처 연결하기

내가 사용한 어뎁터는

![캡처](https://github.com/user-attachments/assets/3e505cf3-a3b6-477d-9d14-9652174d4ee3)

`ipTIME N150UA3 USB 2.0 무선 랜카드 노트북용`으로 usb 2.0만 지원하기에 영상과 달리 usb설정을 변경하지 않았다

이거 모니터 모드가 될 지는 의문

![image](https://github.com/user-attachments/assets/6fb53c90-7ebd-43cb-8866-b1d86e10d1c1)

일단은 연결하지 않았을 때에 무선 네트워크가 없는 모습

![image](https://github.com/user-attachments/assets/96276afc-788d-4a4e-b061-820374edec3a)

그리고 연결하면? 아주 잘 나온다

### 4-4. 맥(MAC) 주소란 무엇이며 어떻게 변경하는가

MAC : Media Access Control - 미디어 액세스 제어

자세한 설명은 [맥 어드레스](https://oil-lamp-cat.github.io/posts/CCNA-%EA%B3%B5%EB%B6%80-1/#%EB%A7%A5-%EC%96%B4%EB%93%9C%EB%A0%88%EC%8A%A4-mac-address)에 정리해 두었다

이번 강의에서는 MAC 주소를 바꾸지만 물론 이것은 물리적 주소를 바꾼 것이 아니기에 컴퓨터(VM)을 끄면 다시 리셋된다

왜 맥 주소를 바꾸려고 할까?

1. 익명성이 증가한다
2. 다른 장치를 사칭할 수 있다
3. 필터를 우회할 수 있다

그럼 이제 직접 MAC주소를 변경해보자

1. 변경을 위해 장치를 내리기

```
root@kali:~# ifconfig wlan0 down
```

2. MAC주소를 변경

```
wlan0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
        ether ca:82:d7:50:34:09  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0

```

라는 `ifconfig`결과를 보면 중간에 `ether ca:82:d7:50:34:09 `이라는 부분이 존재하는데 이게 바로 MAC주소이다

그럼 이제 변경을 위한 명령어를 입력하자

중간에 `hw`옵션은 우리가 변경할 것이 하드웨어 장치이기에 사용한 것이다

```
root@kali:~# ifconfig wlan0 hw ether 00:11:22:33:44:55
```

3. 다시 네트워크 사용

```
root@kali:~# ifconfig wlan0 up
```

이제 다시 확인해보면?

```
wlan0: flags=4099<UP,BROADCAST,MULTICAST>  mtu 1500
        ether 00:11:22:33:44:55  txqueuelen 1000  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
```

아주 잘 바뀐 것을 알 수 있다

### 4-5. 무선 모드 (관리 모드와 모니터 모드)

네트워크 상에서 모든 데이터는 패킷의 형태로 전송된다

그 안에는 목적지의 MAC주소 발송지의 MAC주소가 모두 포함된다

무선 네트워크에서 같은 범위 내에 있는 패킷을 캡쳐하기 위해서는 무선 네트워크의 모드를 변경해 주어야 한다

모드 확인을 해보자

```
root@kali:~# iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0     IEEE 802.11  ESSID:off/any  
          Mode:Managed  Access Point: Not-Associated   Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Encryption key:off
          Power Management:off
```

지금은 일단 관리(Managed)모드이다

하지만 우리가 네트워크에 돌아다니는 패킷을 캡쳐하기 위해서는 모니터(Monitor)모드로 바꿀 필요가 있다

그를 위해 우리는 먼저 네트워크 데몬을 죽여(kill) 놓을 필요가 있다

```
root@kali:~# ifconfig wlan0 down
root@kali:~# airmon-ng check kill

Killing these processes:

    PID Name
   1443 wpa_supplicant

root@kali:~# 
```

그런데..?

```
root@kali:~# iwconfig wlan0 mode monitor
Error for wireless request "Set Mode" (8B06) :
    SET failed on device wlan0 ; Device or resource busy.
```

어... 장치가 작동중이라는데.. 일단 자료를  찾아보자

찾았다!! [github issue 링크](https://github.com/mfruba/kernel/issues/28#issuecomment-1881588834)

```
root@kali:~# sudo apt install -y realtek-rtl8188eus-dkms
```

를 통해 드라이버를 추가로 설치하자

```
root@kali:~# ifconfig wlan0 down
root@kali:~# iwconfig wlan0 mode monitor
root@kali:~# iwconfig
lo        no wireless extensions.

eth0      no wireless extensions.

wlan0     IEEE 802.11  Mode:Monitor  Tx-Power=20 dBm   
          Retry short limit:7   RTS thr:off   Fragment thr:off
          Power Management:off
          
root@kali:~# 
```

아주 잘 되었다

분명 전에 작업 할 때에는 되었는데 갑자기 안되서 당황했지만 해결!

마지막으로 `ifconfig wlan0 up`하는 것은 잊지 말것

## 5. 네트워크 해킹 - 연결 전 공격

### 5-1. 패킷 스니핑 기초

이제 모니터 모드로 설정 했으니 공기중 모든 패킷을 캡쳐할 수 있다

패킷 스니핑을 위해 `airodump-ng`를 사용할 것인데 `aircrack-ng`안에 포함되어있다

저번에 포트 스캐너를 만들어 봤으니 이번에는 `aircrack`을 간소하게나마 구현해 보고 싶다

```
root@kali:~airodump-ng wlan0
```
를 통해 스니핑을 시작하면

![image](https://github.com/user-attachments/assets/7d47cd24-b298-42b4-ae0f-624d9034d846)

음.. 왜 많지?

![image](https://github.com/user-attachments/assets/d4eea38d-8c10-4e86-b493-a60dbe35c52d)

분명 핸드폰에서는 두개만 뜨는데 참 이상하다

와중에 저 `Samsung StickVacuum`는 우리집도 아니고 옆집 무선 청소기이다... 거리가 최소 40M는 되보이는데 이게 잡히네

그리고 나머지는 감도 안 잡힌다.

나는 결과에서

```
 BSSID PWR Beacons #Data, #/s  CH   MB   ENC CIPHER  AUTH ESSID
```

이 부분에 궁금증이 생겨서 조금 조사를 해봤다

> BSSID

Basic Service Set Identifier

와이파이 네트워크에서 특정 무선대역 또는 WLAN에 할당되는 MAC주소를 의미한다

> PWR

PoWeR

신호의 세기, 어떻게 보면 거리가 될 수도 있다

조사하는데 자동차 이야기가 먼저 나와서 당황..

> Beacons

네트워크에서 보낸 beacon 패킷의 개수

모든 네트워크는 숨겨져있어도 `나 살아있어요!`패킷을 보내게 된다

> \#data

캡쳐된 패킷 수

> \#/S

10초동안 측정한 초당 패킷 수

> CH

네트워크가 실행되는 채널

잘 이해가 안되어서 [모두의 네트워크 정리](https://velog.io/@kimmainsain/%EB%AA%A8%EB%91%90%EC%9D%98-%EB%84%A4%ED%8A%B8%EC%9B%8C%ED%81%AC-%EC%A0%95%EB%A6%AC-9) 참고

> MB

네트워크가 지원하는 최대 속도

> ENC

네트워크 암호화 방식

> CIPHER

네트워크에 사용되는 암호

ENC랑 분명한 차이가 있다

ENC는 네트워크의 암호화 방식이고 CIPHER는 네트워크에 사용중인 암호의 암호화 방법

> AUTH

네트워크에 사용되는 인증방식

> ESSID

네트워크의 이름

찾다보니 매우 좋은 사이트를 발견했다

[How to sniff Wi-Fi packets using airodump-ng](https://www.inkyvoxel.com/how-to-sniff-wi-fi-packets-using-airodump-ng/)

최고!

### 5-2. Wi-Fi 대역 - 2.4Ghz & 5Ghz 주파수

와이파이 대역 2.4Ghz와 5Ghz

`airodum-ng`를 이용해 위와 같이 그냥 입력하게 되면 2.4Ghz대역의 네트워크만 캡쳐하게 된다

5Ghz 대역 캡쳐를 위해 다음과 같이 입력하자

```
root@kali:~# airodump-ng --band a wlan0
```

그리고 내 랜카드는 5Ghz를 지원하지 않기에 

![image](https://github.com/user-attachments/assets/af0ed38d-21a3-42a4-91ef-875d4f4ea04c)

아무 결과도 잡지 못한다

모든 대역을 캡쳐하기 위해서는

```
root@kali:~# airodump-ng --band abg wlan0
```

옵션을 추가해 주면 된다

물론 조금 느려지지만

### 5-3. 타겟 패킷 스니핑

특정 네트워크의 패킷만을 스니핑 하기 위해서 내 노트북 핫스팟을 이용하기로 했다

![image](https://github.com/user-attachments/assets/02690c48-0472-482b-bf78-0c30aa54ce7e)

핫스팟의 BSSID는 `32:89:4A:3F:61:4B`이니 패킷 스니핑을 해보자

```
root@kali:~# airodump-ng --bssid 32:89:4A:3F:61:4B --channel 6 --write test wlan0
```

이번에는 --write를 통해 패킷을 test라는 파일에 저장하도록 하였다

![image](https://github.com/user-attachments/assets/f3332380-d6de-4f4c-8e9f-711945cb0065)

핸드폰으로 연결하여 패킷을 캡쳐하는데 성공했다

아까 저장한 파일은

```
root@kali:~# ls
Desktop    Music     Templates                         test-01.cap         test-01.kismet.netxml
Documents  Pictures  Videos                            test-01.csv         test-01.log.csv
Downloads  Public    embedded-browser-no-sandbox.json  test-01.kismet.csv
```

여러 형태로 나누어져 저장되었다

위 패킷을 읽기 위해서는 많은 방법이 있지만 그 중 가장 많이 쓰는 wireshark를 이용한 방법이 있다

### 5-4. 연결해제 공격(네트워크에서 어떤 기기든 연결 해제하기)

[Deauth Attack을 통한 와이파이 무력화](https://dundole.tistory.com/12)에 매우 자세하게 설명되어있기에 추천한다

## 6. 네트워크 해킹 - 액세스 획득 - WEP 해킹

### 6-1. 액세스 획득 소개

이번 섹션에서는 네트워크가 암호화를 쓸 때 그 암호화를 뚫고 액세스 하는 방법을 배우게 된다

예를 들어 WEP, WPA, WPA2 등의 암호화 방법일 때

### 6-2. WEP 암호화 해킹 이론

> Wired Equivalent Privacy

오래된 방법이지만 아직도 쓰이는 곳이 있다

WEP는 보통 RC4라고 불리는 암호화 방법을 사용한다

> 쉽게 설명하자면 

1. `Hello world`라는 문장을 가진 데이터가 있다고 했을 때 이 데이터를 `키`를 가지고 `ADLKFJLD`이런식의 암호화된 데이터로 변경한다

2. 그리고 이 패킷이 공중을 타고 날아가면 다시 AP(Access Point), 보통은 라우터에서 다시 `키`를 이용해 원래 데이터로 변경하여 읽는다

라우터에서 클라이언트로 데이터를 전송할 때에도 동일하다

특징은 `양 쪽 모두에게 키가 있어야 한다` 그래야 키가 없는 사람은 데이터를 찾아내도 데이터를 열어볼 수 없으니까

> 좀 더 상세하게 설명하면

1. WEP는 공기중에 전송되는 모든 데이터 마다 고유한 키를 생성한다. 그걸 위해 24비트짜리 랜덤 값을 가진 초기화 벡터(IV)를 만든다
2. 그리고 이 IV를 사용자가 네트워크에 연결할 때 사용하는 암호 앞에 붙이는데 이 키 스트림을 패킷의 암호화에서 사용한다

예를들면

IV + Key(password) = Key stream

의 과정으로 키 스트림을 만들고

KeyStream + "Hello World"를 합쳐서 `ADLKFJLD`가 되는 식이다

3. 데이터를 전송할 때에는 라우터가 데이터를 복호화 할 수 있도록 데이터 앞에 초기화 백터(IV)를 붙여서 전송하게 된다

```
IV
-----
ADLKFJLD
```

여기서 문제가 생긴다

바로 IV는 암호화 되지 않았다는 것이다

심지어 24비트로 길이가 정해져 있다!

만약 트래픽이 많은 네트워크가 있다면 중복된 초기화 벡터가 많아질 테니 [통계적 분석 공격](https://zidarn87.tistory.com/103)에 취약해 진다

아니 처음에 사람들은 어떻게 이걸 생각해냈지? 진짜 뚫는 사람도 대단하고 막아내려고 고안한 사람도 대단하다... 멋있다

### 6-3. WEP 해킹 기초

WEP 해킹을 하기 위해서는 위에서 말했듯이 네트워크에 트래픽이 많아야 한다

그래야 많은 패킷을 얻어내고 그러면 중복된 IV값이 늘어나니 통계 분석 공격을 하기 용이해 진다

패킷을 캡쳐 하기 위해서는 `airodump-ng`를 사용하고

패킷을 분석하기 위해서는 `aircrack-ng`를 사용한다

어.. 영상을 따라가며 테스트를 위해 WEP 네트워크를 하나 만들려고 했는데 일단 윈도우로는 아무리 핫스팟을 만들어도 암호화 종류를 설정할 수가 없다. 일단은 한번 우분투로 가서 보자

![image](https://github.com/user-attachments/assets/71827c96-cafb-4af4-8777-8123775f60cd)

아.. 안되나? 왜 설정에 WEP가 없을까...

![image](https://github.com/user-attachments/assets/06850f46-a5c4-4dc3-95d5-5b993be59f8e)

아하 내 랜카드가 애초에 WEP를 지원을 안하네... 심지어 iptime도 지원을 안한다. 허... 옛날 카드가 남아있는지 찾아봐야겠다

WEP 300Mbps 11n USB무선 랜카드

![image](https://github.com/user-attachments/assets/497eeccb-25de-4f0c-af9a-53bb5a9d5052)

판매를 봤을 때는 된다고 써있는데 어쩌면 ubuntu에서 막는 걸지도

와 깜짝이야 [우분투 용량에 의한 검은화면 부팅 문제](https://oil-lamp-cat.github.io/posts/%EC%9A%B0%EB%B6%84%ED%88%AC-%EB%B6%80%ED%8C%85-%EA%B2%80%EC%9D%80%ED%99%94%EB%A9%B4-%EC%9A%A9%EB%9F%89/)가 갑자기 발생하는 바람에 일단 글 쓰는 것을 잠깐 중단했다

> 그렇게 위 문제를 해결한 뒤 찾다 찾다 WEP 생성에 관한 내용을 못찾겠어서 Chat GPT에게 물어보니

WEP(Wired Equivalent Privacy)은 보안성이 낮아, 현대 운영체제에서 기본적으로 지원되지 않습니다. WEP는 여러 보안 취약점으로 인해 쉽게 해킹될 수 있기 때문에 대부분의 운영체제는 WPA(Wi-Fi Protected Access)와 WPA2, WPA3 같은 더 안전한 암호화 방식을 기본적으로 사용하고 있습니다.

그럼에도 불구하고, 특정한 목적으로 WEP를 사용해야 하는 경우, 다음과 같은 방법으로 설정할 수 있습니다.

#### 1. Ubuntu에서 WEP 설정하기
Ubuntu에서는 `hostapd`를 사용하여 핫스팟을 설정할 수 있습니다. `hostapd`는 기본적으로 WPA를 사용하지만, 구성 파일을 수동으로 편집하여 WEP를 설정할 수 있습니다.

1. **Hostapd 설치**
```bash
sudo apt-get install hostapd
```

1. **구성 파일 설정**
`/etc/hostapd/hostapd.conf` 파일을 편집합니다.
```bash
sudo nano /etc/hostapd/hostapd.conf
```

다음 내용을 추가하여 WEP를 사용하도록 설정합니다.
```
interface=wlan0
ssid=YourSSID
hw_mode=g
channel=1
auth_algs=1
wep_default_key=0
wep_key0=1234567890
```

여기서 `wlan0`는 네트워크 인터페이스의 이름이며, `wep_key0`는 10자리의 WEP 키입니다.

3. **Hostapd 시작**
```bash
sudo systemctl start hostapd
```

4. **Hostapd 상태 확인**
```bash
sudo systemctl status hostapd
```

5. **Hostapd 종료**
```bash
sudo systemctl stop hostapd
```

위와 같은 작업을 통해 해결할 수 있다고 한다

추가적으로 자동시작되는 것을 막기 위해서는

```bash
sudo systemctl disable hostapd
```

실행하면 ubuntu에서는 아래와 같이 실행된다

![image](https://github.com/user-attachments/assets/368132c1-25cb-485c-aebb-d12a646fb84c)

그 후 vm칼리에서 모니터 모드로 설정 후

![image](https://github.com/user-attachments/assets/ee2ce3b7-ec8a-4450-906c-4fef6996505b)

`airodum-ng`를 통해 캡쳐해보면

어.. 없다.. 그 이유를 찾기 위해 다시 우분투로 가보면

```
 8월 28 22:19:09 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: disassociated
 8월 28 22:19:09 seolhwa systemd[1]: Started hostapd.service - Access point and authentication server for Wi-Fi and Ethernet.
 8월 28 22:24:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: deauthenticated due to inactivity (timer DE>
 8월 28 22:24:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: disassociated
 8월 28 22:29:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: deauthenticated due to inactivity (timer DE>
 8월 28 22:29:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: disassociated
 8월 28 22:34:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: deauthenticated due to inactivity (timer DE>
 8월 28 22:34:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: disassociated
 8월 28 22:39:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: deauthenticated due to inactivity (timer DE>
 8월 28 22:39:27 seolhwa hostapd[17589]: wlo1: STA 50:46:ae:d4:c3:1a IEEE 802.11: disassociateds
```

계속 시도는 하는데 WEP를 생성하지 못한다

그럼 다른 랜카드로 테스트를 해봐야겠지?

바꾸자 마자

![Screenshot from 2024-08-28 09-46-55](https://github.com/user-attachments/assets/689d3416-7209-4465-8a97-edeea0a82bcf)

바로 잡혔다

아주 기분이 좋다 해결했다 이거야!!!

그럼 이제 다시 강의를 따라가보자

이제 wep 네트워크를 생성했으니 타겟 네트워크만 캡쳐하기 위해 옵션을 추가하자

```bash
root@kali:~# airodump-ng --bssid 00:1E:A6:B0:01:E3 --channel 1 --write basic_wep wlan0
```

![Screenshot from 2024-08-28 09-54-54](https://github.com/user-attachments/assets/b873e9bd-c8c7-463b-862a-ca0376d76926)

하지만 나는 네트워크에 다른 기기를 연결하지 않았기에 현재 `#DATA`부분에 보이는 데이터 전송량이 0이다

원래 [6-3 강의](https://oil-lamp-cat.github.io/posts/Udemy-%ED%99%94%EC%9D%B4%ED%8A%B8-%ED%95%B4%ED%82%B9-101-%EC%9C%A4%EB%A6%AC%EC%A0%81-%ED%95%B4%ED%82%B9-%EA%B8%B0%EC%B4%88%EB%B6%80%ED%84%B0-%EB%B0%B0%EC%9A%B0%EA%B8%B0/#6-3-wep-%ED%95%B4%ED%82%B9-%EA%B8%B0%EC%B4%88)에서는 이미 데이터 패킷이 많을 때에 캡쳐해서 데이터를 처리하는 방식을 공부하고 그 후에 나올 `6-4 강의`에서 강제로 데이터를 생성해내어 그 패킷을 검출하는 작업을 할 것이다

![Screenshot from 2024-08-28 10-01-56](https://github.com/user-attachments/assets/16d166ab-d3d3-4b6c-9374-9c7db34d2e73)

일단 지금 만들어진 패킷을 통해 검사를 해 보았을 때에는 역시 데이터가 오간 것이 없으니 검출되는 것도 없다

### 6-4. 가짜 인증 공격

딱히 네트워크 상에 데이터가 오가지 않고 있다면 우리는 어떻게 암호를 해독할 수 있을까?

바로 강제로 데이터를 만들어 내게 하면 된다!

우리가 필요한건 `IV`니까 사실 굳이 데이터가 포함되어있을 필요는 없다

여기에는 한가지 문제가 있다

1. AP(Access Point)는 연결되어있지 않은 기기의 요청은 무시해 버린다, 또한 결합(Associate)되지 않은 기기 또한 마찬가지이다

> 여기서 잠깐 연결(Connect)은 비밀번호를 입력해 통신하는 것이고 결합(Associate)은 그저 AP에게 "나는 너와 연결을 하고 싶어! 그러니 내 요청을 무시하지 말아줘!"라고 말하는 것이다

우리가 AP에 처음 연결할 때 PW를 칠 탠데 만약 PW가 틀렸다 하여도 AP에서 "너 비밀번호 틀렸어" 라고 답장이 온다 이것이 바로 `결합(Associate)`이다

![Screenshot from 2024-08-28 10-19-49](https://github.com/user-attachments/assets/1aadcbd0-e888-481e-b1bd-fc70d22f06a6)

그럼 이제 `가짜 인증 공격(FakeAuthenticate)`을 할 차례다

위 창부터 설명하자면

1. 노트북에서 만든 WEP 네트워크 캡쳐중
2. `aireplay-ng`의 `fakeauth`공격, 사용법은 아래에
3. 무선 어댑터 맥 주소를 가져오기 위한 작업, `unsepec` 혹은 `ether` 다음에 나오는 12자리 숫자를 이용한다

```bash
aireplay-ng --fakeauth [횟수] -a [타겟 맥 주소] -h [내 무선 어뎁터 주소] [모니터 모드 활성화된 무선 어뎁터]
```

![Screenshot from 2024-08-28 10-25-59](https://github.com/user-attachments/assets/6129a032-8816-4ecd-8695-bec114c6704e)

연결을 시작하게 되면 맨 처음 프롬프트의 `AUTH`가 `OPN`즉 OPEN으로 바뀌었음을 알 수 있다

이렇게 우리는 AP와 결합되었다!

### 6-5. ARP 요청 리플레이 공격

결합에 성공했으니 이제 AP와 통신은 가능해졌다

이제 패킷을 트래픽에 주입시켜서 AP가 강제로 IV를 가진 새로운 패킷들을 만들어 내게 할 수 있다

그것을 위해 이번 강의에서는 `ARP(Address Resolution Protocol) 요청 리플레이 공격`을 이용할 것이다

ARP에 관한 자세한 설명은 좋은 [블로그](https://musclebear.tistory.com/12)가 있어 참고한다

강의를 보니 나중에 추가 설명을 한다고 한다

![Screenshot from 2024-08-28 10-34-13](https://github.com/user-attachments/assets/2884b695-e0ee-441c-a802-dd1a402af030)

사용법은 거의 `FakeAuth`랑 비슷하다

```bash
aireplay-ng --arpreplay -b [타겟 맥 주소] -h [내 무선 어뎁터 주소] [모니터 모드 활성화된 무선 어뎁터]
```

이렇게 하면 내 무선 어댑터가 ARP 패킷을 기다리다가 만약 네트워크 상에 ARP 패킷이 전송되었다는 것이 보이면 그것을 캡쳐하고 재전송 하게 된다

그 후에는 AP가 계속해서 새로운 패킷과 새로운 IV(초기화 벡터)를 계속해서 만들어내게 된다

이제 기다리면 한번이라도 ARP 패킷을 찾아내게 되면 그 때부터 arpreplay가 시작될 것이다

만 아무래도 라우터가 아니라 내가 직접 만들었다보니 아예 패킷이 없어 시작도 못했다

![Screenshot from 2024-08-28 10-43-43](https://github.com/user-attachments/assets/8b8e0fef-e077-41c6-93da-c3ac5be54537)

하지만! 핸드폰으로 잠시 연결해서 성공했다

그렇게 생성된 파일을 `aircrack-ng`를 통해 해독해보면?

![Screenshot from 2024-08-28 10-46-14](https://github.com/user-attachments/assets/a9614d3e-9d48-4832-96ea-be479f4a1c7e)

비밀번호가 `12:34:56:78:90`이라고 한다

원래는 `1234567890`이지만 저 상태로 입력하여도 놀랍게 연결이 된다

## 7. 네트워크 해킹 액세스 획득 - WPA - WPA2 해킹

### 7-1. WPA와 WPA 2 해킹 소개