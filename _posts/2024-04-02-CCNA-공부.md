---
title: "CCNA 공부를 위해"
date: 2024-04-02 21:09:15 +09:00
categories: [CCNA]
tags: [노력]
---

# 공부하고 기억하기 위한 기록

## 네트워킹이란?

 네트워킹 (Networking)은 '장비가 서로 대화가 가능하도록 묶어주는 것' 이다.

## 인터넷, 인트라넷, 엑스트라넷?

### 인터넷 (Internet) : 여러개의 네트워크를 묶은 것
 1. 프로토콜(대화규칙 : TCP/IP)를 사용한다.
 2. 웹 브라우저를이용해 탐험이 가능하다.

### 인트라넷 (IntraNet)
> 내부 네트워크
### 엑스트라넷 (ExtraNet)
> 인트라넷을 기업 내 외에도 사용할 수 있도록 한 것

## LAN(Local Area Network)
 어느 한정된 공간에서 네트워크를 구성한다.
## WAN(Wide Area Network)
 멀리 떨어진 지역을 서로 연결하는 경우에 사용한다.

## 이더넷 (Ethernet)
 > 인터넷 아닙니다.
 이더넷은 네트워킹의 한 방식이다.

 CSMA/CD 프로토콜을 이용하여 통신을 하게 된다.

 쉽게말해 통신하려는 네트워크를 살펴본 후 아무도 통신하고있지 않으면 본인 데이터를 실어보내고 잘 보내졌는지 확인하는 방식이다.

 ### CSMA/CD
  > Carrier Sense Multiple Access/Collision Detection

  Carrier Sense : 네트워크 자원(캐리어)를 감지한다.

  Multiple Access : 동시에 접속이 가능하다.

  Collision Detection : 여러 장비가 동시에 정보를 전달하면 충돌이 발생한다.

  충돌이 감지되면 랜덤한 시간동안 최대 15번 까지 데이터 전송을 시도하고 그 이후에는 데이터 전송을 포기한다.

## 토큰링 (TokenRing)
 &nbsp; 이더넷은 데이터를 보내고 싶으면 마음껏 보내지만 토큰링 방식은 네트워크상에서 토큰을 가진 한 PC만이 네트워크에 데이터를 보낼 수 있는 방식이다.

## TP 케이블

> Twisted - Pair Cable

### UTP 케이블

> Unshielded Twisted - Pair Cable
>
> 케이블 주위를 절연체로 감싸지 않음

### STP 케이블

> shielded Twisted - Pair Cable
>
> 케이블 주위를 절연체로 감싸고 있음
>
> 주로 토큰링 쪽에서 사용 

### 카테고리 - 데이터 전송 속도에 따라서 나뉜다.

- 카테고리 1 : 전화망에 사용, 데이터 전송용 X
- 카테고리 2 : 4Mbps 속도로 데이터 전송
- 카테고리 3 : 최대 10Mbps, 속도까지 데이터 전송가능
- 카테고리 4 : 최대 16Mbps, 토큰링에서 사용되는 케이블
- 카테고리 5 : 최대 100Mbps, 였으나 이제는 Gbps속도의 전송도 가능해짐
- 카테고리 6 : 최대 10Gbps , Cat6와 Cat6a 케이블로 구분되고 a가 붙은 케이블이 좀 더 개선된 케이블이다.
- 카테고리 7 : 10Gbps 이상의 속도 지원

### 케이블 이름

> 예시를 들어보자
- 10 Base T

 10Mbps의 속도를 지원하는 Baseband용(베이스밴드- 디지털방식, 브로드밴드 - 아날로그 방식)이고 T(Twisted Pair) 케이블이다..

- 10 Base T : 10Mbps로 통신하고 최대 전송거리 100M인 UTP케이블
- 10 Base FL : 10Mbps로 통신하는 광케이블 FL(Fiber - Optic)
- 10 Base 2 : 10Mbps로 통신하고 200M까지 전송가능한 케이블

 이런 식으로 명명된다.

## 맥 어드레스 (MAC Address)

 > MAC (Media Access Control) OR Physical Address (물리적 주소)

 > IP, IPX (Logical 주소)

 - ARP : Address Resolution Protocol - IP주소를 다시 MAC으로 바꾸는 절차

 네트워크 장비들은 48bit(6Octet)의 주소를 갖는다. 이 주소를 `맥 어드레스` 혹은 `하드웨어 주소`라고 한다. 맥 어드레스는 8자리마다 `-` `:`  `.` 으로 고분된다.

 앞쪽 6개의 16진수는 벤더(생산자)를 의미한다. 이 코드를 `OUI(Organizational Unique Identifier)`라고 한다. 뒤에 나오는 6자리 수는 `Host Identifier(시리얼 넘버)`이다.

 ```
 O는 OUI, H는 host identifier

 OOOO.OOHH.HHHH
 ```

## 유니캐스트, 브로드캐스트, 멀티캐스트
> Unicast, Broadcast, Multicast

### 유니캐스트 (Unicast)
 1 대 1, 보내는 사람과 받는 사람의 MAC주소가 프레임에 들어있다. 

 - 여러 사람한테 보내게 되면 트래픽이 증가하기에 그 때에는 Multicast를 이용한다.

 `편지 보내기`

### 브로드캐스트 (Broadcast)
 로컬 랜(브로드캐스트 도메인)에 붙어있는 모든 네트워크 장비들에게 보내는 통신

 - 브로드캐스트 MAC 주소는 정해져있다. (FFFF.FFFF.FFFF)

 - 처음 두 PC 간에 통신을 하는 경우 상대의 MAC 주소를 알아내기 위해 ARP(Address Resolution Protocol)을 한다.

 - 브로드캐스트는 유니캐스트와 달리 CPU에 영향을 주게된다.

 `동내 이장님 방송`

### 멀티캐스트 (Multicast)

 그룹 멤버들에게만 한번에 보낼 수 있다.

 - 라우터나 스위치에서 기능을 지원해 주어야지만 사용가능하다.

 - 만약 지원되지 않는 라우터나 스위치를 사용하면 스위치는 모든 포트에 뿌리고 라우터는 브로드캐스트라고 인식하여 차단한다.

### 정리

 - 유니캐스트 - 특정 한 PC에만 보내는 방식
 - 브로드캐스트 - 브로드캐스트 도메인 안에있는 모든 PC에 전송, PC(CPU) 성능이 떨어지게된다.
 - 멀티캐스트 - 위 두 방식의 장점을 결합해 놓았지만 라우터나 스위치가 지원하여야 사용 가능하다.
  
## OSI 7 Layer 
 > Open Systems Interconnection

 - Application Layer (애플리케이션 계층)
 - Presentation Layer (프레젠테이션 계층)
 - Session Layer (세션 계층)
 - Transport Layer (트랜스포트 계층)
 - Network Layer (네트워크 계층)
 - Data Link Layer (데이터 링크 계층)
 - Physical Layer (피지컬 계층)

애프세트네데피 로 외워봅시다.

### 가장 아래 계층 레이어 1 Physical Layer

 전기적, 기계적 특성을 이용해 통신 케이블로 데이터를 전송. 
 > 케이블, 리피터, 허브 등

### 레이어 2 Data Link Layer

 송,수신되는 정보의 오류와 흐름을 관리하여 안전한 정보의 전달을 할 수 있도록 도와준다. MAC 주소로 통신할 수 있도록 해준다. 
 
 이 계층에서 전송되는 단위를 `프레임`이라고 부른다. 
  > 브리지, 스위치

### 레이어 3 NetWork Layer

 경로를 선택하고, 주소 선정, 경로를 따라 패킷을 전달해 주는 역할.
 
 > 라우터, Layer 3 스위치

### 레이어 4 Transport Layer

 흐름 컨트론, 에러 복구 기능을 가진다.

 > TCP, UTP

보낼 떄에는 AH -> PH

받을떄에는 PH -> AH

보낼 때에 여러 헤더와 같은 정보가 붙기에 속도가 좀 더 느리게 나온다.

## 프로토콜 (Protocol)

 > PC가 서로 통신하기 위한 협약, 규약이다.

 같은 프로토콜을 가져야 서로 통신이 가능하다.

### TCP/IP
 > Transmission Control Protocol/ Internet Protocol

 TCP, UTP - 트랜스포트 계층
 IP - 인터넷 계층

### IPX
 > Internetwork Packet eXchange

 파일 서버와 클라이언트 간에 통신에서 사용하는 방법 - 요즘에는 거의 없어졌다.

## IP주소
 > 전 세계적으로 유일한 주소, 둘이쓰면 충돌나서 한명 밖에 못쓴다.

 NIC(Network Information Center)에서 공인 주소를 관리한다.

### NAT
> Network Address Translation

 내부 네트워크에서는 공인되지 않은 IP 주소를 사용하고 인터넷으로 나갈 떄에만 공인 주소를 사용하는 방법

IPv4의 수는 최대 2^32개이다.

IPv6의 수는 최대 2^128개이다.

## DHCP
 > Dynamic Host Configuration Protocol

 PC마다 하나하나 IP 주소를 미리 지정해 놓지 않고 DHCP 서버가 네트워크에 필요한 IP 주소를 가지고 있다가 자동분배해주는 방식

## NIC | 랜카드
> Network Interface Card, 네트워크 어뎁터

### PC의 버스 방식
 > 버스 (컴퓨터에 데이터가 날아다니는 길)

 PCI, ISA, EISA 방식이 있다.

## HUB 허브
 > 같은 허브에 연결된 PC끼리는 서로 통신이 가능하다.

 허브 = 멀티포트(Multiport) 리피터 (Repeater)

 UTP 케이블 최대 거리가 대부분 100미터이지만 리피터를 이용하여 거리를 더 늘릴 수 있다.

 허브는 CSMA/CD 방식을 사용한다. 같은 허브에 연결되어있는 모든 PC를 `같은 Collision Domain`에 있다고 한다.

 파워를 넣으면 바로 작동 - 명령어 불필요

### HUB의 종류
 > Intelligent hub, Dummy hub, Semi-Intelligent hub, Stackable hub

### 인텔리전트 허브 (Intelligent hub)
> 지능형 허브

NMS(Network Management System)을 통해 데이터 분석, 제어 등 관리 가능

문제가 발생한 PC가 연결된 포트를 자동으로 고립(네트워크에서 불리)시키는 기능을 가지고 있다.

또한 분리된 포트는 허브에서 램프(LED)로 표시되기 떄문에 조치가 쉬워진다. (Auto Partition)

### 세미 더미 허브 (Semi Dummy hub)

 > 카멜레온

인텔리전트 허브와 연결하면 인텔리전트 허브가 되고

혼자 있을 때는 더미 허브

### 스태커블 허브 (Stackable hun)
 > 쌓을 수 있는 허브

  다른 장비에는 형향을 주지 않는다. 

  단독형(Standalone)에 비해 효율적으로 설계되었다.

## 브리지 (Bridge), 스위치 (Switch)
 > 콜리전 도메인을 나누어 줄 수 있는 장비

 속도 : 브리지 < 스위치

 ### 스위치 (Switch)

 `포트별로 콜리전 도메인이 나누어져 있다.` 고로 PC들도 동시 통신이 가능하다.

 이거 자꾸 까먹는다.

 > 스위치와 허브의 가장 큰 차이이다.

![허브와 스위치의 차이](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/1e73ae65-01e3-42c4-804e-f8813c7a0f22)


위는 고속도로로 네트워크 흐름을 비유한 것

### 허브와 스위치의 차이

 > 가격 : 허브 < 스위치
 >
 > 속도 : 허브 > 스위치

 허브는 네트워크 트래픽이 적은 채팅이나 메일 용도

 허브는 콜리전 도메인을 나눠줄 수 없지만 스위치는 가능하다

 ![스위치는 콜리전 도메인을 나눌 수 있다](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/6d585a5f-8d79-4fa9-ab47-d2fffbb0bdf0)

스위치는 라우터까지의 길 또한 콜리전 도메인에 포함된다.

### 브리지 (Bridge)
 
 > 브리지는 허브로 만들어진 콜리전 도메인 사이에 중간 다리를 놓는 것 

 사실상 스위치와 사촌

### 브리지, 스위치의 기능

 - Learning 배운다.
 - Flooding 모르면 들어온 포트를 제외한 다른 모든 포트로 뿌린다.
 - Forwarding 해당 포트로 건네준다.
 - Filtering 다른 포트로는 못 건너가게 막는다.
 - Aging 나이를 먹는다?

 > Learning : 출발지의 MAC 어드레스를 배운다.
 
 어떤 컴퓨터가 브리지나 스위치를 통해 통신을 하기 위해 프레임을 보내면 보낸 PC의 MAC 주소를 `MAC 주소 테이블 (브리지 테이블)`에 저장한다.

 > Flooding : 들어온 포트를 제외한 나머지 모든 포트로 뿌린다.

 Mac 어드레스 테이블에 없는 주소일 경우

 브로드캐스트나 멀티 캐스트의 경우에도 발생한다.

 > Forwarding (포워딩) : 목적지가 어디있는지 알고 있지만 목적지가 다리를 건너야 하는 경우 발생한다.

 Flooding과 달리 특정 포트에만 프레임을 뿌려준다.

 > Filtering (필터링) : 브리지를 넘어가지 못하게 한다.

 목적지의 MAC주소를 알고 있고 출발지와 목적지가 같은 세그먼트에 있는 경우, 브리지를 건너가지 않아도 통신을 할 수 있을 경우 필터링한다.

 이 기능으로 인해 콜리전 도메인을 나누어 줄 수 있다.

 > Aging : 나이를 먹는다?

 브리지 테이블은 어느정도 시간이 지나면 정보를 브리지 테이블에서 지우게 된다. 마치 우리 머리 속처럼.

 디폴트 기억시간은 5분

 300초가 지나도록 그 출발지 주소를 가진 프레임이 들어오지 않으면 브리지 테이블에서 삭제시킨다.

 Aging 타이머를 리프래시 (Refresh)한다 : 시간 안에 브리지로 들어오게 되면 타이머를 리셋하고 처음부터 다시 카운트 한다.

 ### 브리지와 스위치의 차이점

 > 속도 : 스위치가 브리지에 비해 훨씬 빠르다.

 스위치는 하드웨어 방식으로 이루어지고 브리지는 소프트웨어 방식으로 프레임을 처리한다. 사용한다.

 > 속도 지원
 
 스위치는 서로 다른 속도를 연결해 줄 수 있지만 허브는 모든 포트가 같은 속도만 지원된다.

 > 포트 수

 스위치는 브리지에 비해 제공하는 포트 수가 훨씬 많다.

 > 프레임 처리 방식

 스위치 : Cut-through, Store-and-forward
 
 브리지 : Store-and-forward

 - 스토어 앤 포워드 (Store-and-forward) : 프레임을 전부 받아들인 후 처리, 에러가 발생하면 프레임을 전부 버리고 재전송 요구, 에러 복구 능력 뛰어남
  
 - 컷스루 (Cut-through) : 프레임의 목적지와 주소만 본 후 바로 전송 처리, 목적지 주소만 보고 바로 보내기에 처음 48bit만 본다. 에러 복구 능력 부족

 - 프래그먼트 프리 (Fragment-free) : 위 두 방식의 장점을 결합, 처음 512bit만 보고 에러 판단

## Looping

 > 프레임이 네트워크상에서 무한정 돌게되어 데이터 전송이 불가능해지는 상태

 브리지/스위치에 목적지까지의 경로가 두개 이상 존재하면 루핑 발생

 ![루핑](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/6f17008f-484e-42ac-b9eb-cd85f897ef3c)

 이 현상을 막기 위한 알고리즘 `스패닝 트리 알고리즘 (Spanning Tree Algorithm)`

## 폴트 톨러런트 (Fault Tolerant), 로드 밸런싱 (Load Balancing)

 > 폴트 톨러런트

 `두 대`의 라우터로 네트워크를 구성 한 후 한 대가 죽었을 때 다른 라우터가 기존 라우터를 대체하는 것

 장애  대비책으로 대부분 이중구조를 의미하고 전체 네트워크가 하나의 지점에서 발생한 장애로 인해 영향 받는 것을 방지하기 위한 것.

 > 로드 밸런싱

  하나의 인터넷 회선을 이용한 인터넷 접속 대신 두개의 인터넷 회선을 이용하는 것.

  데이터가 두 라인중 하나를 선택하기에 로드가 분산되는 효과를 얻어 속도가 두배가 된다.

  추가적으로 회선이 하나가 끊어지면 다른 회선으로 이전하게 되는데 이 떄를 로드 밸런싱과 폴트 톨러런트를 겸하게 된다.

 ## 스패닝 트리 알고리즘 (Spanning Tree Algorithm)

 > 자동으로 루핑을 검색해서 루핑이 발생할 수 있는 상황을 미리 막아주는 역할을 한다.

 스위치 간의 링크 중 하나를 끊어 놓는 것이다. 실제 링크는 두 개이지만 데이터는 한 쪽으로만 다니게 하는 것이다.

 루핑을 미리 막기 위해 두 개 이상의 경로가 발생하면 하나를 제외하고 나머지 경로를 자동으로 막아두었다가 기존 경로에 문제가 생기면 막아놓은 경로를 풀어서 데이터를 전송하는 알고리즘

 링크가 끊어진 후 다시 연결되는 대 까지는 약 1분 이상 소요된다.

 ## 라우팅 혹은 스위칭

 가격 : 라우터가 스위치보다 비싸다

 속도 : 라우터는 내부에서 처리하는 것이 많기에 스위치가 더 빠르다.

 구성의 편리함 : 스위치는 전원만 공급해 주면 된다.


 그럼 스위치로만 구성하면 되는가? 아니다.

 통신을 할 때에 상대편 MAC 주소를 찾기 위해 ARP(Address Resolution Protocol), 브로드캐스트를 사용

 스위치는 콜리전 도메인만 나눌 뿐. 브로드캐스트 도메인을 나눠주기 위해 라우터를 사용한다. 라우터 역할을 하는 스위치를 `레이어 3 스위치`라고 부른다.

 ![브로드캐스트 도메인](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/abdaddae-7dfe-44e0-a48d-ec25d4c70149)

 브로드캐스트 영역을 나눌 때에는 사용하는 프로토콜이나 프로그램에 따라 차이가 있다.

 - IP : 500 노드
 - IPX : 300 노드
 - AppleTalk : 200 노드
  
 노드 : 네트워크에 접속되는 장비, 주로 PC 숫자

 라우터는 스위치가 못하는 보안 기능인 `패킷 필터링` 기능을 제공한다. 네트워크 주소에 따라 전송을 막았다가 풀었다 하는 필터 기능을 제공하여 불필요한 트래픽이 전송되는 것을 막는다.

 또한 `로드 분배`기능을 가지고 있다.
 - 로드 분배 : 여러 개의 경로를 가지고 있기에 한쪽 경로에 문제가 생겨도 바로 다른 경로로 보낼 수 있다.

## IP 주소

 > 규칙이 있는 개인 번호

 IP 주소는 이진수 32자리로 되어있기에 총 2^32개가 있다. 읽기 쉽게 하기 위해서 IP 주소를 총 4개의 옥텟(8)으로 나눈다.

 ### IP 배정 방식
 라우터에 배정해야 하는 IP 주소는 두개

 1. 이더넷 인터페이스용
 2. 시리얼 (Serial) 인터페이스용 

 ### 네트워크 부분과 호스트 부분

 > 한 네트워크 : 하나의 브로드캐스트 영역, 라우터를 거치지 않고 통신이 가능한 영역

 한 네트워크 상에서 `네트워크 부분`은 모두 같아야 하며 `호스트 부분`은 전부 달라야한다.

 라우터의 인터페이스를 건너뛰면서 네트워크가 달라진다.

 ### IP 주소의 Class

 > 네트워크의 크기에 따른 구분법

 - 클래스 A : 맨 앞쪽 하나가 항상 0으로 시작된다.
  
 `0xxx xxxx`.xxxx xxxx.xxxx xxxx.xxxx xxxx
 
 `앞의 8비트`는 네트워크 부분, 나머지 24비트는 호스트 부분

 네트워크 번호가 1~126으로 시작, 하지만 127은 제외 이건 약속

 호스트가 전부 0인 경우는 네트워크 주소이고 호스트가 전부 1인 경우는 호스트 모두에게 전송하는 브로드캐스트 주소이기 떄문에 가능한 호스트 수는 `2^24 - 2`개 이다.

 - 클래스 B : 맨 앞이 반드시 10(이진수)로 시작된다.
  
 `10xx xxxx.xxxx xxxx`.xxxx xxxx.xxxx xxxx

 `앞의 16비트`는 네트워크 부분, 나머지 16비트는 호스트 부분

 네트워크 번호가 128.1 ~ 191.255로 시작

 모두 0인 경우와 모두 1인 브로트캐스트 주소를 제외한

 가능한 호스트의 수는 `2^16 - 2`개 이다

 - 클래스 C : 맨 앞이 110(이진수)로 시작된다.

 `110x xxxx.xxxx xxxx.xxxx xxxx`.xxxx xxxx

 `앞의 24비트`는 네트워크 부분, 나머지 8비트는 호스트 부분이다.

 네트워크 번호가 192.0.0 ~ 223.255.255 로 시작

 가능한 호스트 수는 위와 동일한 이유로 `2^8 -2`개 이다.

### IP 클래스 정리

 - 클래스 A : 1~126 (127은 예비번호), 255.0.0.0
 - 클래스 B : 128~191, 255.255.0.0
 - 클래스 C : 192~223, 255.255.255.0
 - 클래스 D : 224~239 (멀티캐스트용 주소)
 - 클래스 E : 240~255 (연구용 주소)

## 서브넷 마스크 (Subnet Mask)

> 주어진 IP 주소를 네트워크 환경에 맞게 나누어 주기 위해서 씌워주는 이진수의 조합

브로트캐스트 영역을 나누기 위해 사용한다.

> 서브넷 마스크는 IP 주소를 가지고 어디 까지가 네트워크 부분이고 어디까지가 호스트 부분인지를  나타내는 역할을 한다.

네트워크는 서브넷 마스크가 이진수로 `1`인 부분이고 호스트는 이진수로 `0`인 부분이다.

### 서브네팅 (Subnetting)

하나의 주소를 서브넷 마스크를 씌워서 작은 네트워크로 만드는 것을 의미한다.

기존 IP 주소의 호스트 부분의 일부를 네트워크 부분으로 바꾸는 작업

ex)

`150.150.100.1`의 디폴트 서브넷 마스크는 255.255.0.0 이지만 새로운 서브넷 마스크인 255.255.255.0을 씌워 클래스 B 주소를 마치 클래스 C 처럼 사용하는 것이다.

### 서브넷 마스크의 기본 성질

>서브넷은 하나의 네트워크이기 때문에 서로 나뉜 서브넷 끼리는 라우터를 통해서만 통신이 가능하다.

- 서브넷 마스크는 이진수로 썼을 떄 `1`이 연속적으로 나와야 한다. 1과 1사이에 0이 있으면 안된다.

1111 1111.1111 1111.1111 1111.1110 0000 -> 가능 <br/>
1111 1111.1111 1111.1111 1111.1011 0000 -> 불가능

## 스패닝 트리 (Spanning Tree Protocol, SPT)

 > 목적지가 2개 이상 존재할 때 1개의 경로만 남겨두고 나머지는 끊어두었다가 사용하던 경로에 문제가 생기면 다른 하나를 사용하는 방법

 ### 브리지 ID (BID)

 Bridge ID 는 총 64비트(8Byte)로 이루어저 있고 그 중 앞의 16비트(2Byte)는 `Bridge Priority`, 나머지 48비트(6Byte)는 `Mac Address`로 구성되어있다.

 > `xxxx xxxx xxxx xxxx` oooo oooo oooo oooo oooo oooo oooo oooo oooo oooo oooo oooo

 그 중 `Bridge Priority`는 2^16 - 1 가지가 올 수 있으며 디폴트 값은 중간 값인 32768(16 진수로는 8000)을 사용한다. `Mac Address`는 앞과 마찬가지로 고정된 값이다.

 > Priority는 낮은 값이 더 높은 우선순위를 갖는다.
 
 ### Path Cost

 > 브리지가 얼마나 가까이, 빠른 링크로 연결되어있는지 알아내기 위한 값이다

 원래 계산법은 1000Mbps를 연결되어있는 링크 대역폭으로 나눈 값이다

 예를들어 10Mbps로 연결되어있는 두 스위치라면 Path cost는  100이다

 차지만 요즘은 속도가 더 빨라졌기 때문에 소수점까지 값이 내려가는 것을 방지하기 위해 값을 고정시켜 놓았다.
 
 |Bandwidth(대역폭)|STP Cost(path Cost)|
 |:---:|:---:|
 |4Mbps|250|
 |10Mbps|100|
 |16Mbps|62|
 |45Mbps|39|
 |100Mbps|19|
 |155Mbps|14|
 |622Mbps|6|
 |1Gbps|4|
 |100Gbps|2|

 ### 스패닝 트리 프로토콜

 > 1. 네트워크당 하나(브로드캐스트 도메인)의 루트 브리지(Root Bridge)를 가진다
 > 2. 루트 브리지가 아닌 나머지 모든 브리지(Non Root Bridge)는 무조건 하나씩의 루트 포트(Root Port)를 가진다
 > 3. 세그먼트(Segment)당 하나씩의 데지그네이티드 포드(Designated Port)를 갖는다

#### Root Bridge?

 스패닝 트리 프로토콜을 수행할 때 기준이 되는 브리지(혹은 스위치)

#### Non Root Bridge?

 루트 브리지를 제외한 모든 브리지(스위치), 무조건 하나씩의 `루트 포트`즉 루트 브리지까지 가장 빨리 갈 수 있는 포트를 가진다

#### Segment?

 브리지(스위치) 사이에 서로 연결된 링크

 세그먼트당 하나씩의 지정포트(Designated Port)를 갖는다

 ![스패닝트리 프로토콜](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/e7888ee0-3ba5-46cf-84a4-33f3e0a05217)

스패닝트리 프로토콜에서 루트 포트나 지정포트가 아닌 나머지 모든 포트는 막아버린다

### STP에서의 순서

 > 1. 누가 더 작은 Root BID를 가졌는가?
 > 2. 루트 브리지까지의 Path Cost 값은 누가 더 작은가?
 > 3. 누구의 BID(Sender BID)가 더 낮은가?
 > 4. 누구의 포트 ID가 더 낮은가?
 
 브리지(스위치)는 스패닝 트리 정보를 주고받기 위해 매 2초 간격으로 `BPDU(Bridge Protocol Data Unit)`을 뿌리고 이를 통해 포트를 결정하게 된다

 BPDU 안에는 `Root BID`, `Root Path Cost`, `Sender Bid`, `Port ID`를 담고있다

 루트 포트 -> Designated Port -> Non Designated Port

### 실제 스위치에서 값 변경, 확인하기

```
sw(config)#spanning-tree vlan 1 priority 100

sw(config)#show spanning-tree
```

추후 전체적인 실습 기록할 떄 없어질 수도

### STP에서 루트 포트 선출하기

 > Path Cost가 가장 적게 드는 포트가 가장 루트 포트에 가까이 있다는 의미

 ![루트 브리지 선출](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/e4bc62f1-0fdc-4a01-8b55-84872a6d88c7)

 위 예시에서 스위치 A는 루트 브리지, 스위치 B의 E0와 스위치 C의 E0가 루트 포트이다

### STP에서 Designated Port 선출하기

 > 세그먼트 상에서 Root Path Cost를 서로 비교해서 더 작은 Root Path Cost를 가진 포트가 Designated Port로 선출된다

 ![Designated Port](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/d932775c-dd49-49d2-b87d-3856578f104f)

 위 예시에서는 세그먼트 1에서는 스위치 A의 E0, 세그먼트 2에서는 스위치 A의 E1이 Designated Port가 된다

 - 루트 브리지의 모든 포트들은 언제나 Designated Port로 선정

 세그먼트 3에서는 Root Path Cost값이 같기에 위의 4단계를 통해 결정하게 된다

 책의 예시에서는 Sender BID, 즉 자신의 BID값이 더 작은 B의 E1이 Designated Port로 선정되었다

 그리고 나머지 포트 (여기서는 스위치 C의 E1)은 `ND(Non Designated Port)`가 된다

 ![STP 결과](https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/b0e6dcb8-4f62-403f-97c6-93bfdf36a3dd)


 ### STP에서 스위치 포트의 5가지 상태변화

 #### Disabled

 고장나서 사용 불가이거나 일부러 정지시켜 놓은 상태

 - 데이터 전송 불가
 - MAC Address Learning 불가
 - BPDU 송신 및 수신 불가

 #### Blocking

 맨 처음 켜지거나 Disable상태에서 활성화 시켰을 때

 - 데이터 전송 불가
 - MAC Address Learning 불가
 - BPDU 송신 및 수신 가능

 #### Listening

 Blocking 상태에 있던 포트가 루트 포트나 Designated Port로 선정되면 Listening 상태로 변경, 하지만 다른 포트로 상태가 변하면 다시 Blocking 상태가 된다

 - 데이터 전송 불가
 - MAC Address Learning 불가
 - BPDU 송신 및 수신 가능

 #### Learning

 Listening 상태에 있던 포트가 포워딩 딜레이(Forwarding Delay) 디폴트 시간인 15초 동안 유지되면 러닝 상태로 변경, 이제야 MAC Address 테이블을 만들기 시작

 - 데이터 전송 불가
 - MAC Address Learning 가능
 - BPDU 송신 및 수신 가능

 #### Forwarding

 Learning 상태에서 변하지 않고 포워딩 딜레이 디폴트 시간인 15초 동안 유지되면 포워딩 상태로 변경

 - 데이터 전송 가능
 - MAC Address Learning 가능
 - BPDU 송신 및 수신 가능

 <img src = "https://github.com/oil-lamp-cat/oil-lamp-cat.github.io/assets/103806022/8f48c018-6da3-41e5-b4c9-42c912b840a5" width="75%" height="75%">
